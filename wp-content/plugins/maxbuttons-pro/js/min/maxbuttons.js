var maxAdminPro;jQuery(document).ready(function(t){maxAdminPro=function(){this.pack_loader_process=0,this.uploader=null},"undefined"!=typeof maxAdmin&&(maxAdminPro.prototype=new maxAdmin),maxAdminPro.prototype.init=function(){""!==mbpro_options.colorPalette&&(this.colorPalettes=mbpro_options.colorPalette),maxAdmin.prototype.init.call(this),t("#license_not_active").length>0&&t(".form-actions").html(t("#license_not_active").children().clone()),t("#packs_tab a").on("click",this.togglePacksTabs),t(document).on("get-free-packs",t.proxy(this.loadFreePacks,this)),t(document).on("click",".load_pack_preview",t.proxy(this.loadPackPreview,this)),t("#export-form").on("submit",t.proxy(this.checkExportForm,this)),t(document).on("change",'.pack-list input[type="checkbox"]',t.proxy(this.togglePackButton,this)),t(document).on("click",'.pack-list-header button[name="import_button"]',t.proxy(this.importPackButtons,this)),t(document).on("click",".pack-list .shortcode-container a",function(e){e.preventDefault(),t(e.target).parents("label").trigger("click")}),this.togglePackButton(),t("#add_data_attr").on("click",t.proxy(this.add_data_attr,this))},maxAdminPro.prototype.update_color=function(e,a,o){this.saveIndicator(!0);var r=t(e.target),n=t(r).attr("id");t("#"+n).val(o),-1!==n.indexOf("icon")?window.maxFoundry.maxIcons.updateIcon(r):maxAdmin.prototype.update_color.call(this,e,a,o)},maxAdminPro.prototype.togglePackButton=function(){if(0!=t(".pack-list").length){var e=t('.pack-list input[type="checkbox"]:checked').length;t(".pack-list-header .count").text(e),0==e?t(".pack-list-header button").prop("disabled",!0):t(".pack-list-header button").prop("disabled",!1)}},maxAdminPro.prototype.importPackButtons=function(e){var a=0,o=0,r=t('.pack-list input[type="checkbox"]:checked');o=r.length;var n=this;r.each(function(e){var r=t(this).val(),c=t('.pack-list div[data-button="'+r+'"]').text();c={action:"import_button",data:c},t.post({url:maxajax.ajax_url,data:c,success:t.proxy(function(t){a++,this.importPackButtonDone(t,o,a)},n)})})},maxAdminPro.prototype.importPackButtonDone=function(e,a,o){var r=JSON.parse(e);void 0===r.button||r.button,a==o&&(t('input[name="import_modal"]').trigger("click"),t('.pack-list input[type="checkbox"]:checked').prop("checked",!1),this.togglePackButton())},maxAdminPro.prototype.updateAnchorText=function(e){var a=t("#text").val(),o=t("#text2").val();this.button_id;t(".mb-text").text(a),t(".mb-text2").text(o),""==o?t(".mb-text2").hide():(t(".mb-text2").show(),t(".mb-text2").css("display","block"))},maxAdminPro.prototype.updateFont=function(t){window.maxFoundry.maxfonts.checkFonts()},maxAdminPro.prototype.togglePacksTabs=function(e){e.preventDefault();var a=t("#packs_tab a.nav-tab-active"),o=t(e.target);t(a).removeClass("nav-tab-active"),t(o).addClass("nav-tab-active");var r=t(a).data("screen"),n=t(o).data("screen");t("#"+r).hide(),t("#"+n).show(),"free_packs_screen"==n&&t(document).trigger("get-free-packs")},maxAdminPro.prototype.loadFreePacks=function(){if(0!==this.pack_loader_process)return!1;this.pack_loader_process=1;var e={remote_action:"get_free_overview",action:"pack_request",nonce:t("#free-pack-nonce").text()};t.ajax({url:maxajax.ajax_url,type:"GET",dataType:"html",data:e,success:t.proxy(this.updateFreePacksScreen,this)})},maxAdminPro.prototype.updateFreePacksScreen=function(e,a){this.pack_loader_process=0,t(".free_packs .pack_container").html(e),t(".free_packs .loading").hide(),t(".free_preview").hide(),t(".free_packs").show(),t(document).off("click",".free_packs .use"),t(document).on("click",".free_packs .use",t.proxy(this.getFreePackDownloadLink,this))},maxAdminPro.prototype.loadPackPreview=function(e){e.preventDefault();var a=t(e.target).closest("[data-pack]").data("pack"),o=t(e.target).closest("[data-pack]").data("packname");this.pack_loader_process=2;var r={remote_action:"get_free_pack_preview",action:"pack_request",pack_url:a,pack:o,nonce:t("#free-pack-nonce").text()};t.ajax({url:maxajax.ajax_url,type:"GET",dataType:"html",data:r,success:t.proxy(this.showPackPreview,this,o)})},maxAdminPro.prototype.showPackPreview=function(e,a,o){this.pack_loader_process=0,t(".free_preview .results").html(a),t(".free_packs").fadeOut(),t(".free_preview").fadeIn(),window.maxFoundry.maxfonts.checkFonts(),t(".free_preview .use").data("pack",e),t(document).off("click",".free_preview .use"),t(document).off("click",".free_preview .close"),t(document).on("click",".free_preview .close",function(){t(".free_packs").fadeIn(),t(".free_preview").fadeOut()}),t(document).on("click",".free_preview .use",t.proxy(this.getFreePackDownloadLink,this))},maxAdminPro.prototype.getFreePackDownloadLink=function(e){if(t(e.target).hasClass("disabled"))return!1;var a=t(e.target).data("pack");this.pack_loader_process=3;var o={remote_action:"get_free_download_link",action:"pack_request",pack:a,nonce:t("#free-pack-nonce").text()};t.ajax({url:maxajax.ajax_url,type:"GET",dataType:"html",data:o,success:t.proxy(this.packDownload,this,a)})},maxAdminPro.prototype.packDownload=function(t,e){try{e=JSON.parse(e)}catch(t){}if(void 0===e.status){a="";if(""!==window.location.port&&void 0!==window.location.port)var a=":"+window.port;var o=window.location.protocol+"//"+window.location.host+a+window.location.pathname;window.location.href=o+"?page=maxbuttons-controller&action=pack&id="+t}else alert("An error occured: "+e.error_message)},maxAdminPro.prototype.deletePack=function(e){e.target;var a=t(e.target).attr("href");t(e.currentModal).find(".yes").attr("href",a)},maxAdminPro.prototype.checkExportForm=function(e){return""!=t('input[name="pack_name"]').val()||(t('input[name="pack_name"]').css("border","1px solid #ff0000"),!1)},maxAdminPro.prototype.add_data_attr=function(e){var a=t(".option.anchor_data").first().clone(),o=t(".data_attr_plus").data("attrnum");t(a).find(".note").remove(),t.each(t(a).find("input"),function(e,a){t(a).attr("id",t(a).attr("id")+"_"+o),t(a).attr("name",t(a).attr("name")+"_add["+o+"]"),t(a).val("")}),t(".option.add_data").before(a),o+=1,t(".data_attr_plus").data("attrnum",o)}});