function mbIcons(){this.current_faicon=null,this.modal=null,this.is_icon=!1,this.is_image=!1,this.has_hover=!1,this.is_textbound=!1,this.is_background=!1}mbIcons.prototype.init=function(){$("#select_icon, #select_hover_icon").on("click",$.proxy(function(t){this.current_faicon=$(t.target).attr("id")},this)),$(document).on("click",".font-awesome ul li",$.proxy(this.selectFAIcon,this)),$(document).on("keyup",".search-input",_.debounce($.proxy(function(t){this.searchIcons()},this),300)),$(document).on("click",".icon-search .category-filter li",$.proxy(this.filterIcon,this)),$(document).on("click",".font-awesome-preview .remove_fa_icon",$.proxy(this.removeIcon,this)),$("#add_hover_image").on("click",function(t){$(".option.icon_hover_option_preview, .option.icon_hover_image_button").removeClass("hidden"),$(this).remove()}),$("#add_hover_icon").on("click",function(t){$(".faicon_hover_preview .font-awesome-preview, #select_hover_icon").removeClass("hidden"),$(this).parent().remove()}),this.attachMediaUploader("icon"),this.attachMediaUploader("icon_hover")},mbIcons.prototype.loadIcons=function(t){this.modal=t;var e=window.maxFoundry.maxAjax,o=e.ajaxInit();o.plugin_action="load_icons",e.ajaxPost(o,$.proxy(this.writeIcons,this))},mbIcons.prototype.writeIcons=function(t){var e=this.modal,o=e.currentModal;(t=JSON.parse(t)).categories&&$.each(t.categories,function(t,e){var i=e.icons,a=e.label,n=i.length;$(o).find(".categories").append('<li data-category="'+t+'" data-icons="'+i+'">'+a+"("+n+")</li>")}),t.icons&&$.each(t.icons,function(t,e){$.each(e,function(t,e){$(o).find(".icon-list").append('<li class="'+e.name+" "+e.category+'" title="'+e.nice_name+'" data-mbicon="'+e.icon+'"> '+e.svg+"</li>")})}),e.checkResize()},mbIcons.prototype.font_awesome_icon=function(){$('input[id="use_fa_icon"]').is(":checked")?($(".non-fa").hide(),$(".fontawesome-only").show(),$(".font-awesome").addClass("checked")):($(".fontawesome-only").hide(),$(".non-fa").show(),$(".font-awesome").removeClass("checked")),this.updateIcon()},mbIcons.prototype.selectFAIcon=function(t){t.preventDefault();var e=$(t.target);void 0===e.data("mbicon")&&(e=$(e).parents("li"));var o={};o.value=$(e).data("mbicon"),o.svg=$(e).find("svg")[0].outerHTML,window.maxFoundry.maxadmin.saveIndicator(!0),"select_icon"==this.current_faicon?(mode="normal",$("#fa_icon_value").val(o.value),$(".font-awesome-preview .the-icon.normal").html(o.svg)):(mode="hover",$("#fa_icon_hover_value").val(o.value),$(".font-awesome-preview .the-icon.hover").html(o.svg)),window.maxFoundry.maxmodal.close(),this.updateIcon(mode,o)},mbIcons.prototype.updateIcon=function(t){t=t||"",this.is_icon=$('input[id="use_fa_icon"]').is(":checked");var e=$('input[id="bind_to_text"]').is(":checked"),o=$("#icon_position").val();this.is_icon||(this.is_image=!1),this.is_background="background"==o,this.is_textbound=!(this.is_background||!e);var i=parseInt($("#icon_padding_top").val()),a=parseInt($("#icon_padding_right").val()),n=parseInt($("#icon_padding_bottom").val()),s=parseInt($("#icon_padding_left").val());(isNaN(i)||i<0)&&(i=0),(isNaN(a)||a<0)&&(a=0),(isNaN(n)||n<0)&&(n=0),(isNaN(s)||s<0)&&(s=0);var c=i+"px "+a+"px "+n+"px "+s+"px",r=$("#icon_url").val(),l=$("#icon_hover_url").val();$(".output .result").find(".mb-icon").remove();$(".output .result a.normal").html(),$(".output .result a.hover").html();if(this.is_icon||""!=r||""!=l){$(".output .result a .mb-icon, .output .result a .mb-icon-hover").remove();var p=$(".output .result a.normal"),d=$(".output .result a.hover");if(this.is_textbound)var p=$(".output .result a.normal .mb-text"),d=$(".output .result a.hover .mb-text");"bottom"==o?(p.append("<span class='mb-icon'  > </span>"),d.append("<span class='mb-icon'  > </span>")):this.is_textbound&&"right"==o?(p.append("<span class='mb-icon'  > </span>"),d.append("<span class='mb-icon'  > </span>")):(p.prepend("<span class='mb-icon' ></span>"),d.prepend("<span class='mb-icon' ></span>"));var u=$(".output .result a .mb-icon");switch(u.css({padding:c,display:"block",lineHeight:"0px"}),o){case"left":u.css("float","left");break;case"right":u.css("float","right");break;case"top":case"bottom":u.css("textAlign","center");break;case"background":var m=$('input[name="background_position_horizontal"]').val(),h=$('input[name="background_position_vertical"]').val();u.css({backgroundPosition:m+"% "+h+"%","background-repeat":"no-repeat",position:"absolute","box-sizing":"border-box",backgroundRepeat:"no-repeat",padding:"0",left:"0",right:"0",top:"0",bottom:"0"})}this.is_textbound&&(u.css("float","none"),"left"!=o&&"right"!=o||u.css("display","inline-block"),"top"!=o&&"bottom"!=o||u.css("display","block"),u.css("verticalAlign","middle")),this.is_icon?this.updateFontAwesomeIcon():this.updateImageIcon("icon")}},mbIcons.prototype.updateFontAwesomeIcon=function(t,e){var o=$("#fa_icon_value").val(),i=$("#fa_icon_hover_value").val(),a=$(".font-awesome-preview .the-icon.normal").html(),n=$(".font-awesome-preview .the-icon.hover").html(),s=$(".output .result a.normal .mb-icon"),c=$(".output .result a.hover .mb-icon"),r=$(".output .result a .mb-icon");0==i.length&&(n=a);var l=$("#icon_position").val();if(""!=o){var p=$("#fa_icon_size").val(),d=$("#icon_color").val(),u=$("#icon_color_hover").val(),m=$(a),h=$(n);m.find("path").attr("fill",d),h.find("path").attr("fill",u),"background"==l?(r.css("backgroundSize",p+"px "+p+"px"),s.css("backgroundImage","url(data:image/svg+xml;charset=utf-8,"+escape(m.prop("outerHTML"))+")"),c.css("backgroundImage","url(data:image/svg+xml;charset=utf-8,"+escape(h.prop("outerHTML"))+")")):(s.append(m),c.append(h),r.find("svg").width(p),r.find("svg").height(p),this.is_textbound&&(r.css("fontSize",p+"px"),r.css("lineHeight",p+"px"))),$(".font-awesome-preview .remove_fa_icon").show()}else $(".output .result a .mb-icon").css("padding","")},mbIcons.prototype.updateImageIcon=function(t){var e=t+"_hover",o={},i={};o.url=$("#"+t+"_url").val(),o.alt=$("."+t+"_data .alt").text(),o.title=$("."+t+"_data .atttitle").text(),i.url=$("#"+e+"_url").val(),o.alt=$("."+e+"_data .alt").text(),o.title=$("."+e+"_data .atttitle").text(),void 0!=typeof i.url&&""!=i.url||(i=o);var a=$(".output .result a.normal .mb-icon"),n=$(".output .result a.hover .mb-icon"),s=($(".output .result a .mb-icon"),$("#icon_position").val());parseInt($("#icon_padding_left").val()),parseInt($("#icon_padding_top").val());"background"==s?(a.css("backgroundImage","url("+o.url+")"),n.css("backgroundImage","url("+i.url+")")):(a.html('<img src="'+o.url+'" alt="'+o.alt+'" title="'+o.title+'" >'),n.html('<img src="'+i.url+'" alt="'+i.alt+'" title="'+i.title+'" >'))},mbIcons.prototype.searchIcons=function(){$(".icon-search .spinner").css("visibility","visible");var t=$(".max-modal .search-input").val(),e=[],o=[];if($(".category-filter li.selected").each(function(){void 0===$(this).data("icons")?o.push($(this).data("category")):(icons=$(this).data("icons"),icons=icons.split(","),$.merge(e,icons))}),$(".icon-list li").hide(),t.length>0&&$('.icon-list li[class*="'+t+'"]').show(),e.length>0){var i=(e=e.map(function(t){return"."+t})).join(",");$(".icon-list").find(i).show()}if(""==t&&0==e.length&&$(".icon-list li").show(),o.length>0){var a=(o=o.map(function(t){return"."+t})).join(",");$(".icon-list li").not(a).hide()}$(".icon-search .spinner").css("visibility","hidden")},mbIcons.prototype.filterIcon=function(t){var e=$(t.target);$(e).data("icons");$(e).hasClass("selected")?$(e).removeClass("selected"):$(e).addClass("selected"),this.searchIcons()},mbIcons.prototype.attachMediaUploader=function(t){$("#image_"+t+"_button").on("click",{key:t},$.proxy(function(e){var o=this;e.preventDefault(),this.uploader=wp.media.frames.mb_media_frame=wp.media({title:$(this).data("uploader_title"),button:{text:$(this).data("uploader_button_text")},id:"maxbuttons-wp-image-picker",frame:"post",state:"insert",library:{type:"image"},multiple:!1}),this.uploader.on("insert",function(){var e=o.uploader.state().get("selection").first().toJSON(),i=e.sizes,a=$(".media-frame").find("select.size").val(),n=e.url;i[a]&&i[a].url&&(n=i[a].url),$("#"+t+"_url").val(n),$(".image_"+t+"_preview").find("img").remove(),$(".image_"+t+"_preview").prepend('<img src="'+n+'">'),$("#"+t+"_id").val(e.id),$("#"+t+"_size").val(a),$("#"+t).trigger("keyup"),$("."+t+"_preview .remove_icon").show(),$("."+t+"_data .alt").text(e.alt),$("."+t+"_data .atttitle").text(e.title),$("."+t+"_data .filename").text(e.filename),window.maxFoundry.maxadmin.saveIndicator(!0),o.updateIcon()}),this.uploader.on("uploader:ready",function(){var e=o.uploader.state().get("selection");id=$("#"+t+"_id").val();var i=wp.media.attachment(id);e.add(i?[i]:[])}),this.uploader.open()},this)),$(document).on("click",".image_"+t+"_preview .remove_icon",$.proxy(this.removeImage,this)),!parseInt($("#"+t+"_id").val())>0&&$("."+t+"_preview .remove_icon").hide()},mbIcons.prototype.removeImage=function(t){var e=$(t.target).data("key"),o=$(t.target).parents(".input");$("#"+e+"_id").val(""),$("#"+e+"_url").val(""),$(o).find("img").remove(),$(o).find(".remove_icon").hide(),$(o).find(".icon_data span").text(""),window.maxFoundry.maxadmin.saveIndicator(!0),this.updateIcon()},mbIcons.prototype.removeIcon=function(t){var e=$(t.target),o=$(e).data("mode");if("hover"==o){$("#fa_icon_hover_value").val();$("#fa_icon_hover_value").val("")}else{$("#fa_icon_value").val();$("#fa_icon_value").val("")}$(e).parents(".font-awesome-preview").find(".the-icon").html(""),$(e).hide(),this.updateIcon(o)};