{"version":3,"sources":["ajax-forms/assets/js/ajax-forms.js"],"names":["r","e","n","t","o","i","f","c","u","a","Error","code","p","exports","call","length","1","require","module","Config","objectName","this","prototype","get","k","d","undefined","window","set","v","2","getButtonText","button","innerHTML","value","setButtonText","text","Loader","formElement","form","querySelector","loadingInterval","character","originalButton","cloneNode","setCharacter","start","loadingText","getAttribute","styles","getComputedStyle","style","width","setInterval","tick","bind","opacity","classList","add","loadingChar","stop","clearInterval","remove","3","ConfigStore","busy","config","mc4wp","forms","on","event","element","indexOf","document","activeElement","tagName","blur","loader","fire","request","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","error","console","log","setResponse","process","open","setRequestHeader","send","getSerializedData","trigger","message","errors","data","getData","hide_fields","display","reset","redirect_to","location","href","args","id","submit","returnValue","preventDefault","./_config.js","./_form-loader.js"],"mappings":"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","file":"ajax-forms.min.js","sourcesContent":["(function () { var require = undefined; var define = undefined; (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nfunction Config(objectName) {\n    this.objectName = objectName;\n}\n\nConfig.prototype.get = function (k, d) {\n    return window[this.objectName] !== undefined ? window[this.objectName][k] : d;\n};\n\nConfig.prototype.set = function (k, v) {\n    if (!window[this.objectName]) {\n        window[this.objectName] = {};\n    }\n\n    window[this.objectName][k] = v;\n};\n\nmodule.exports = Config;\n\n},{}],2:[function(require,module,exports){\n'use strict';\n\nfunction getButtonText(button) {\n    return button.innerHTML ? button.innerHTML : button.value;\n}\n\nfunction setButtonText(button, text) {\n    button.innerHTML ? button.innerHTML = text : button.value = text;\n}\n\nfunction Loader(formElement) {\n    this.form = formElement;\n    this.button = formElement.querySelector('input[type=\"submit\"], button[type=\"submit\"]');\n    this.loadingInterval = 0;\n    this.character = '\\xB7';\n\n    if (this.button) {\n        this.originalButton = this.button.cloneNode(true);\n    }\n}\n\nLoader.prototype.setCharacter = function (c) {\n    this.character = c;\n};\n\nLoader.prototype.start = function () {\n    if (this.button) {\n        // loading text\n        var loadingText = this.button.getAttribute('data-loading-text');\n        if (loadingText) {\n            setButtonText(this.button, loadingText);\n            return;\n        }\n\n        // Show AJAX loader\n        var styles = window.getComputedStyle(this.button);\n        this.button.style.width = styles.width;\n        setButtonText(this.button, this.character);\n        this.loadingInterval = window.setInterval(this.tick.bind(this), 500);\n    } else {\n        this.form.style.opacity = '0.5';\n    }\n\n    if (this.form.classList) {\n        this.form.classList.add('mc4wp-loading');\n    }\n};\n\nLoader.prototype.tick = function () {\n    // count chars, start over at 5\n    var text = getButtonText(this.button);\n    var loadingChar = this.character;\n    setButtonText(this.button, text.length >= 5 ? loadingChar : text + \" \" + loadingChar);\n};\n\nLoader.prototype.stop = function () {\n    if (this.button) {\n        this.button.style.width = this.originalButton.style.width;\n        var text = getButtonText(this.originalButton);\n        setButtonText(this.button, text);\n        window.clearInterval(this.loadingInterval);\n    } else {\n        this.form.style.opacity = '';\n    }\n\n    if (this.form.classList) {\n        this.form.classList.remove('mc4wp-loading');\n    }\n};\n\nmodule.exports = Loader;\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nvar ConfigStore = require('./_config.js');\nvar Loader = require('./_form-loader.js');\n\nvar busy = false;\nvar config = new ConfigStore('mc4wp_ajax_vars');\n\n// failsafe against including script twice\nif (!config.get('ready')) {\n\twindow.mc4wp.forms.on('submit', function (form, event) {\n\t\t// does this form have AJAX enabled?\n\t\tif (form.element.getAttribute('class').indexOf('mc4wp-ajax') < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// blur active input field\n\t\tif (document.activeElement && document.activeElement.tagName === 'INPUT') {\n\t\t\tdocument.activeElement.blur();\n\t\t}\n\n\t\ttry {\n\t\t\tsubmit(form);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t\treturn true;\n\t\t}\n\n\t\tevent.returnValue = false;\n\t\tevent.preventDefault();\n\t\treturn false;\n\t});\n}\n\nfunction submit(form) {\n\tvar loader = new Loader(form.element);\n\tvar loadingChar = config.get('loading_character');\n\tif (loadingChar) {\n\t\tloader.setCharacter(loadingChar);\n\t}\n\n\tfunction start() {\n\t\t// Clear possible errors from previous submit\n\t\tform.setResponse('');\n\t\tloader.start();\n\t\tfire();\n\t}\n\n\tfunction fire() {\n\t\t// prepare request\n\t\tbusy = true;\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.onreadystatechange = function () {\n\t\t\t// are we done?\n\t\t\tif (this.readyState == 4) {\n\t\t\t\tclean();\n\n\t\t\t\tif (this.status >= 200 && this.status < 400) {\n\t\t\t\t\t// Request success! :-)\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar response = JSON.parse(this.responseText);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.log('MailChimp for WordPress: failed to parse AJAX response.\\n\\nError: \"' + error + '\"');\n\n\t\t\t\t\t\t// Not good..\n\t\t\t\t\t\tform.setResponse('<div class=\"mc4wp-alert mc4wp-error\"><p>' + config.get('error_text') + '</p></div>');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tprocess(response);\n\t\t\t\t} else {\n\t\t\t\t\t// Error :(\n\t\t\t\t\tconsole.log(this.responseText);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\trequest.open('POST', config.get('ajax_url'), true);\n\t\trequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\t\trequest.send(form.getSerializedData());\n\t\trequest = null;\n\t}\n\n\tfunction process(response) {\n\t\ttrigger('submitted', [form, null]);\n\n\t\tif (response.error) {\n\t\t\tform.setResponse(response.error.message);\n\t\t\ttrigger('error', [form, response.error.errors]);\n\t\t} else {\n\t\t\tvar data = form.getData();\n\n\t\t\t// trigger events\n\t\t\ttrigger('success', [form, data]);\n\t\t\ttrigger(response.data.event, [form, data]);\n\n\t\t\t// for BC: always trigger \"subscribed\" event when firing \"updated_subscriber\" event\n\t\t\t// third boolean parameter indicates this was a BC event\n\t\t\tif (response.data.event === 'updated_subscriber') {\n\t\t\t\ttrigger('subscribed', [form, data, true]);\n\t\t\t}\n\n\t\t\tif (response.data.hide_fields) {\n\t\t\t\tform.element.querySelector('.mc4wp-form-fields').style.display = 'none';\n\t\t\t}\n\n\t\t\t// show success message\n\t\t\tform.setResponse(response.data.message);\n\n\t\t\t// reset form element\n\t\t\tform.element.reset();\n\n\t\t\t// maybe redirect to url\n\t\t\tif (response.data.redirect_to) {\n\t\t\t\twindow.location.href = response.data.redirect_to;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction trigger(event, args) {\n\t\twindow.mc4wp.forms.trigger(event, args);\n\t\twindow.mc4wp.forms.trigger(args[0].id + \".\" + event, args);\n\t}\n\n\tfunction clean() {\n\t\tloader.stop();\n\t\tbusy = false;\n\t}\n\n\t// let's do this!\n\tif (!busy) {\n\t\tstart();\n\t}\n}\n\nconfig.set('ready', true);\n\n},{\"./_config.js\":1,\"./_form-loader.js\":2}]},{},[3]);\n })();"]}