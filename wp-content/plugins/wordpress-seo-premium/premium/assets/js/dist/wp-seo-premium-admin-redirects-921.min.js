yoastPremiumWebpackJsonp([6],{1329:function(r,e,n){"use strict";var o=n(522);!function(r){function e(){r("#wpseo_redirects_type").select2({width:"400px",language:wpseoSelect2Locale})}function n(){t=wp.template("redirects-inline-edit"),r.each(r(".redirect-table-tab"),function(e,n){r(n).wpseoRedirects(r(n).attr("id"))}),e()}var t,u=[410,451],c={ORIGIN:1,TARGET:2,TYPE:0},i={ENTER:13},f=function(r){this.form=r};f.prototype.getOriginField=function(){return this.form.find("input[name=wpseo_redirects_origin]")},f.prototype.getTargetField=function(){return this.form.find("input[name=wpseo_redirects_target]")},f.prototype.getTypeField=function(){return this.form.find("select[name=wpseo_redirects_type]")},f.prototype.clearErrorMessage=function(){this.form.find(".wpseo_redirect_form .form_error").remove()},f.prototype.setErrorMessage=function(r){this.form.find(".wpseo_redirect_form").prepend('<div class="form_error error"><p>'+r+"</p></div>")},f.prototype.removeRowHighlights=function(){this.form.find(".redirect_form_row").removeClass("field_error")},f.prototype.highLightRowErrors=function(r){for(var e=0;e<r.length;e++)switch(r[e]){case"origin":this.highlightRow(this.getOriginField());break;case"target":this.highlightRow(this.getTargetField());break;case"type":this.highlightRow(this.getTypeField())}},f.prototype.highlightRow=function(r){jQuery(r).closest("div.redirect_form_row").addClass("field_error")};var a=function(r,e){this.form=r,this.type=e,this.validationError=""};a.prototype.validate=function(){return this.form.clearErrorMessage(),this.form.removeRowHighlights(),!1!==this.runValidation(this.form.getOriginField(),this.form.getTargetField(),this.form.getTypeField())||(this.addValidationError(this.validationError),!1)},a.prototype.runValidation=function(r,e,n){if(""===r.val())return this.form.highlightRow(r),"plain"===this.type?this.setError(wpseoPremiumStrings.error_old_url):this.setError(wpseoPremiumStrings.error_regex);if(-1===jQuery.inArray(parseInt(n.val(),10),u)){if(""===e.val())return this.form.highlightRow(e),this.setError(wpseoPremiumStrings.error_new_url);if(e.val()===r.val())return this.form.highlightRow(e),this.setError(wpseoPremiumStrings.error_circular)}return""!==n.val()||(this.form.highlightRow(n),this.setError(wpseoPremiumStrings.error_new_type))},a.prototype.setError=function(r){return this.validationError=r,!1},a.prototype.addValidationError=function(r,e){this.form.setErrorMessage(r),void 0!==e&&this.form.highLightRowErrors(e)},a.prototype.getFormValues=function(){var r={origin:this.form.getOriginField().val().toString(),target:this.form.getTargetField().val().toString(),type:this.form.getTypeField().val().toString()};return jQuery.inArray(parseInt(r.type,10),u)>-1&&(r.target=""),r};var p=function(){this.row=null,this.quickEditRow=null};p.prototype.setup=function(e,n){this.row=e,this.quickEditRow=r(t({origin:_.unescape(n.origin.html()),target:_.unescape(n.target.html()),type:parseInt(n.type.html(),10),suffix:r("#the-list").find("tr").index(e)}))},p.prototype.getRow=function(){return this.row},p.prototype.getForm=function(){return this.quickEditRow},p.prototype.show=function(){this.row.addClass("hidden"),this.quickEditRow.insertAfter(this.row).show(400,function(){r(this).find(":input").first().focus()})},p.prototype.remove=function(){this.row.removeClass("hidden"),this.quickEditRow.remove()};var l=new p;r.widget("ui.dialog",r.ui.dialog,{_createOverlay:function(){this._super(),this.options.modal&&this._on(this.overlay,{click:function(r){this.close(r)}})}}),r.fn.wpseoRedirects=function(e){var n,t=this,p=e.replace("table-",""),s=!1,h=null,b=function(){s=!1,n=null};this.getButtons=function(e){return"default"===e?[{text:wpseoPremiumStrings.button_ok,click:function(){r(this).dialog("close")}}]:[{text:wpseoPremiumStrings.button_cancel,click:function(){b(),r(this).dialog("close")}},{text:wpseoPremiumStrings.button_save_anyway,class:"button-primary",click:function(){s=!0,n(),r(this).dialog("close"),b()}}]},this.rowCells=function(r){var e=r.find(".val");return{origin:e.eq(c.ORIGIN),target:e.eq(c.TARGET),type:e.eq(c.TYPE)}},this.dialog=function(e,n,o){void 0!==o&&"error"!==o||(o="default");var t=this.getButtons(o);r("#YoastRedirectDialogText").html(n),r("#YoastRedirectDialog").dialog({title:e,width:500,draggable:!1,resizable:!1,position:{at:"center center",my:"center center",of:window},buttons:t,modal:!0,close:function(){h.focus()}})},this.openDialog=function(r){this.dialog(r.title,r.message)},this.post=function(e,n){r.post(ajaxurl,e,n,"json")},this.editRow=function(e){if(r("#the-list").find("#inline-edit").length>0)return void this.dialog(wpseoPremiumStrings.edit_redirect,wpseoPremiumStrings.editing_redirect);l.setup(e,this.rowCells(e)),l.show(),new f(l.quickEditRow).getTypeField().trigger("change")},this.createRedirectRow=function(e,n,o,t){var u=["val"];return t.isTargetRelative&&""!==n&&"/"!==n||u.push("remove-slashes"),t.hasTrailingSlash&&u.push("has-trailing-slash"),r("<tr>").append(r("<th>").addClass("check-column").attr("scope","row").append(r("<input>").attr("name","wpseo_redirects_bulk_delete[]").attr("type","checkbox").val(_.escape(e)))).append(r("<td>").addClass("type column-type has-row-actions column-primary").append(r("<div>").addClass("val type").html(_.escape(o))).append(r("<div>").addClass("row-actions").append(r("<span>").addClass("edit").append(r("<a>").attr({href:"#",role:"button",class:"redirect-edit"}).html(wpseoPremiumStrings.editAction)).append(" | ")).append(r("<span>").addClass("trash").append(r("<a>").attr({href:"#",role:"button",class:"redirect-delete"}).html(wpseoPremiumStrings.deleteAction))))).append(r("<td>").addClass("column-old").append(r("<div>").addClass("val").html(_.escape(e)))).append(r("<td>").addClass("column-new").append(r("<div>").addClass(u.join(" ")).html(_.escape(n))))},this.handleError=function(r,e){r.addValidationError(e.message,e.fields),"warning"===e.type&&t.dialog(wpseoPremiumStrings.error_saving_redirect,e.message,e.type)},this.addRedirect=function(){var e=new f(r(".wpseo-new-redirect-form")),n=new a(e,p);if(!1===n.validate())return!1;var o=n.getFormValues();return t.post({action:"wpseo_add_redirect_"+p,ajax_nonce:r(".wpseo_redirects_ajax_nonce").val(),redirect:{origin:encodeURIComponent(o.origin),target:encodeURIComponent(o.target),type:o.type},ignore_warning:s},function(o){if(o.error)return t.handleError(n,o.error),!0;e.getOriginField().val(""),e.getTargetField().val(""),t.find(".no-items").remove();var u=t.createRedirectRow(o.origin,o.target,o.type,o.info);r("form#"+p).find("#the-list").prepend(u),t.openDialog(wpseoPremiumStrings.redirect_added)}),!0},this.updateRedirect=function(){var e=new f(l.getForm()),n=new a(e,p);if(!1===n.validate())return!1;var o=n.getFormValues(),u=l.getRow(),c=this.rowCells(u);return t.post({action:"wpseo_update_redirect_"+p,ajax_nonce:r(".wpseo_redirects_ajax_nonce").val(),old_redirect:{origin:encodeURIComponent(c.origin.html()),target:encodeURIComponent(c.target.html()),type:encodeURIComponent(c.type.html())},new_redirect:{origin:encodeURIComponent(o.origin),target:encodeURIComponent(o.target),type:encodeURIComponent(o.type)},ignore_warning:s},function(r){if(r.error)return t.handleError(n,r.error),!0;c.origin.html(_.escape(r.origin)),c.target.html(_.escape(r.target)),c.type.html(_.escape(r.type)),l.remove(),t.openDialog(wpseoPremiumStrings.redirect_updated)}),!0},this.deleteRedirect=function(e){var n=this.rowCells(e),u=encodeURIComponent(n.origin.html()),c=encodeURIComponent(n.target.html()),i=encodeURIComponent(n.type.html()),f=p;(0,o.wpseoDeleteRedirect)(u,c,i,f).then(function(){e.fadeTo("fast",0).slideUp(function(){r(this).remove()}),t.openDialog(wpseoPremiumStrings.redirect_deleted)})},this.setup=function(){var e;r("body").append('<div id="YoastRedirectDialog"><div id="YoastRedirectDialogText"></div></div>'),r(window).on("beforeunload",function(){if(r("#the-list").find("#inline-edit").length>0)return wpseoPremiumStrings.unsaved_redirects}),r(".redirect-table-tab").on("change","select[name=wpseo_redirects_type]",function(e){var n=parseInt(r(e.target).val(),10),o=r(e.target).closest(".wpseo_redirect_form").find(".wpseo_redirect_target_holder");jQuery.inArray(n,u)>-1?r(o).hide():r(o).show()}),r(".wpseo-new-redirect-form").on("click",".button-primary",function(){return n=function(){t.addRedirect()},t.addRedirect(),h=r(this),!1}).on("keypress","input",function(r){r.which===i.ENTER&&(n=function(){t.addRedirect()},r.preventDefault(),t.addRedirect())}),r(".wp-list-table").on("click",".redirect-edit",function(n){e=r(n.target).closest("tr"),n.preventDefault(),t.editRow(e),h=r(this)}).on("click",".redirect-delete",function(n){e=r(n.target).closest("tr"),n.preventDefault(),t.deleteRedirect(e),h=r("#cb-select-all-1")}).on("keypress","input",function(r){r.which===i.ENTER&&(n=function(){t.updateRedirect()},r.preventDefault(),t.updateRedirect())}).on("click",".save",function(){(n=function(){t.updateRedirect()})()}).on("click",".cancel",function(){n=null,l.remove(),e.find(".redirect-edit").focus()})},t.setup()},r(n)}(jQuery)},229:function(r,e){r.exports=window.wp.apiFetch},522:function(r,e,n){"use strict";function o(r){return r&&r.__esModule?r:{default:r}}function t(r,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"plain";return(0,f.default)({method:"POST",url:wpApiSettings.root+"yoast/v1/redirects/delete",headers:{"X-WP-Nonce":wpApiSettings.nonce},data:{origin:r,target:e,type:n,format:o}})}function u(r,e,n,o,u){t(r,e,n).then(function(r){"true"===r&&jQuery(u).closest(".yoast-alert").fadeOut("slow")})}function c(r,e,n,o){var t="";if(410!==parseInt(e,10)&&""===(t=window.prompt(wpseoPremiumStrings.enter_new_url.replace("%s",r))))return void window.alert(wpseoPremiumStrings.error_new_url);jQuery.post(ajaxurl,{action:"wpseo_add_redirect_plain",ajax_nonce:n,redirect:{origin:r,target:t,type:e}},function(r){var n=jQuery(o).closest(".yoast-alert");if(jQuery(n).removeClass("updated").removeClass("error"),jQuery(n).find(".redirect_error").remove(),r.error)return void jQuery(n).addClass("error").prepend('<p class="redirect_error">'+r.error.message+"</p>");var t="";t=410===parseInt(e,10)?wpseoPremiumStrings.redirect_saved_no_target:wpseoPremiumStrings.redirect_saved.replace("%2$s","<code>"+r.target+"</code>"),t=t.replace("%1$s","<code>"+r.origin+"</code>"),jQuery(n).addClass("updated").html("<p>"+t+"</p>")},"json")}Object.defineProperty(e,"__esModule",{value:!0}),e.wpseoDeleteRedirect=t,e.wpseoUndoRedirect=u,e.wpseoCreateRedirect=c;var i=n(229),f=o(i)}},[1329]);