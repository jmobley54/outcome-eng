(function($){$(document).ready(function(){var u,checkoutContent=$('#one-page-shopping-checkout-content');function update_checkout(){if(u){u.abort()}var e=[],shipping_methods=[];if(ops_checkout_data.wc_old_version){if($('select#shipping_method').size()>0||$('input#shipping_method').size()>0){e=$('#shipping_method').val()}else{e=$('input[name=shipping_method]:checked').val()}}else{$('select#shipping_method, input[name^=shipping_method][type=radio]:checked, input[name^=shipping_method][type=hidden]').each(function(a,b){shipping_methods[$(this).data('index')]=$(this).val()})}var f=$('#order_review input[name=payment_method]:checked').val();var g=$('#billing_country').val();var h=$('#billing_state').val();var i=$('input#billing_postcode').val();var j=$('input#billing_city').val();var k=$('input#billing_address_1').val();var l=$('input#billing_address_2').val();var m,optart_methods,optart_url;if(ops_checkout_data.wc_old_version){if($('#shiptobilling input').is(':checked')||$('#shiptobilling input').size()==0){var n=g;var o=h;var p=i;var q=j;var r=k;var s=l}else{var n=$('#shipping_country').val();var o=$('#shipping_state').val();var p=$('input#shipping_postcode').val();var q=$('input#shipping_city').val();var r=$('input#shipping_address_1').val();var s=$('input#shipping_address_2').val()}m=woocommerce_params.update_order_review_nonce;optart_methods=e;optart_url=woocommerce_params.ajax_url}else{if($('#ship-to-different-address input').is(':checked')||$('#ship-to-different-address input').size()==0){var n=$('#shipping_country').val();var o=$('#shipping_state').val();var p=$('input#shipping_postcode').val();var q=$('input#shipping_city').val();var r=$('input#shipping_address_1').val();var s=$('input#shipping_address_2').val()}else{var n=g;var o=h;var p=i;var q=j;var r=k;var s=l}m=ops_checkout_data.update_order_review_nonce;optart_methods=shipping_methods;optart_url=ops_checkout_data.ajax_url}var t={action:'woocommerce_update_order_review',security:m,shipping_method:optart_methods,payment_method:f,country:g,state:h,postcode:i,city:j,address:k,address_2:l,s_country:n,s_state:o,s_postcode:p,s_city:q,s_address:r,s_address_2:s,post_data:$('form.checkout').serialize()};u=$.ajax({type:'POST',url:optart_url,data:t,success:function(c){if(c&&c.fragments){$.each(c.fragments,function(a,b){$(a).replaceWith(b);$(a).unblock()})}else{var d=c.html===undefined?c:c.html;$('#order_review').html(d)}}})}$('body').bind('update_checkout',function(){update_checkout()});if(ops_checkout_data.option_guest_checkout==='yes'){var v=$('div.create-account');v.hide();$('input#createaccount').change(function(){v.hide();if($(this).is(':checked')){v.slideDown()}}).change()}checkoutContent.on('input change','select#shipping_method, input[name^=shipping_method], input[name=shipping_method], #shiptobilling input, .update_totals_on_change select, #ship-to-different-address input',function(){$('body').trigger('update_checkout')});checkoutContent.on('click','a.showlogin',function(){$('form.login').slideToggle();return false});checkoutContent.on('click','a.showcoupon',function(){$('.checkout_coupon').slideToggle();$('#coupon_code').focus();return false});checkoutContent.on('submit','form.checkout',function(){var c=$(this);if(c.is('.processing')){return false}if(c.triggerHandler('checkout_place_order')!==false&&c.triggerHandler('checkout_place_order_'+$('#order_review input[name=payment_method]:checked').val())!==false){c.addClass('processing');var d=c.data();$.ajax({type:'POST',url:ops_checkout_data.ajax_url+'?action=woocommerce_checkout',data:c.serialize(),success:function(a){var b='';try{if(a.indexOf('<!--WC_START-->')>=0)a=a.split('<!--WC_START-->')[1];if(a.indexOf('<!--WC_END-->')>=0)a=a.split('<!--WC_END-->')[0];b=$.parseJSON(a);if(b.result==='success'){window.location=decodeURI(b.redirect)}else if(b.result==='failure'){throw'Result failure';}else{throw'Invalid response';}}catch(err){if(b.reload==='true'){window.location.reload();return}$('.woocommerce-error, .woocommerce-message').remove();if(b.messages){c.prepend(b.messages)}else{c.prepend(a)}c.removeClass('processing').unblock();c.find('.input-text, select').blur();$('html, body').animate({scrollTop:($('form.checkout').offset().top-100)},1000);if(b.refresh==='true')$('body').trigger('update_checkout');$('body').trigger('checkout_error')}},dataType:'html'})}return false});checkoutContent.on('submit','form.checkout_coupon',function(){var b=$(this);if(b.is('.processing'))return false;var c,optart_nonce,optart_url;if(ops_checkout_data.wc_old_version){c=woocommerce_params.ajax_loader_url;optart_nonce=woocommerce_params.apply_coupon_nonce;optart_url=woocommerce_params.ajax_url}else{c=ops_checkout_data.ajax_loader_url;optart_nonce=ops_checkout_data.apply_coupon_nonce;optart_url=ops_checkout_data.ajax_url}var d={action:'woocommerce_apply_coupon',security:optart_nonce,coupon_code:b.find('input[name=coupon_code]').val()};$.ajax({type:'POST',url:optart_url,data:d,success:function(a){$('.woocommerce-error, .woocommerce-message').remove();b.removeClass('processing').unblock();if(a){b.before(a);b.slideUp();$('body').trigger('update_checkout')}},dataType:"html"});return false});$('#one-page-shopping-checkout').on('click','.payment_methods input.input-radio',function(){if($('.payment_methods input.input-radio').length>1){var a=$('div.payment_box.'+$(this).attr('ID'));if($(this).is(':checked')&&!a.is(':visible')){$('div.payment_box').filter(':visible').slideUp(250);if($(this).is(':checked')){$('div.payment_box.'+$(this).attr('ID')).slideDown(250)}}}else{$('div.payment_box').show()}if($(this).data('order_button_text')){$('#place_order').val($(this).data('order_button_text'))}else{$('#place_order').val($('#place_order').data('value'))}}).find('input[name=payment_method]:checked').click()})})(jQuery);